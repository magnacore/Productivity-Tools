#!/home/manuj/anaconda3/envs/xonsh/bin/xonsh
light_green = '\x1b[1;32m'
no_color = '\x1b[0m'

import os
import glob
import datetime
from tqdm import tqdm
from tabulate import tabulate

import sys
sys.path.append("/home/manuj/Bin")

from utilities import get_mime, get_duration

allFiles = glob.glob("*.*")
allFiles.sort()

total_duration = 0.0

media_list = []
header = ["Name", "Duration"]

for file in tqdm(allFiles):
	mimestart = get_mime(file)
	if mimestart != None:
		if mimestart in ['audio', 'video']:
			duration = get_duration(file)
			total_duration += duration
			media_list.append([file, datetime.timedelta(seconds = round(duration,0))])
		else:
			print(f"Skipping {file}")

media_list.append([f"{light_green}Total media duration{no_color}",				f"{light_green}{datetime.timedelta(seconds = round(total_duration,0))}{no_color}"])
media_list.append([f"{light_green}Total media duration @1.5x speed{no_color}", 	f"{light_green}{datetime.timedelta(seconds = round(total_duration/1.5,0))}{no_color}"])
media_list.append([f"{light_green}Total media duration @1.65x speed{no_color}",	f"{light_green}{datetime.timedelta(seconds = round(total_duration/1.65,0))}{no_color}"])
media_list.append([f"{light_green}Total media duration @1.82x speed{no_color}",	f"{light_green}{datetime.timedelta(seconds = round(total_duration/1.82,0))}{no_color}"])
media_list.append([f"{light_green}Total media duration @2x speed{no_color}",	f"{light_green}{datetime.timedelta(seconds = round(total_duration/2,0))}{no_color}"])

print(tabulate(media_list, headers=header, tablefmt="fancy_grid"))

print(u'\u2500' * os.get_terminal_size().columns)

sound-play-success &
