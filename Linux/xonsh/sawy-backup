#!/usr/bin/env xonsh

from rich.console import Console
console = Console()

console.rule(f"[bold cyan]Backup Sawy Drive...")

console.print(f"[bold cyan]Deleting previous snapshot...")
sudo btrfs subvolume delete /run/media/$USER/SAWY_01_B/SAWY_BACKUP/@previous

console.print(f"[bold cyan]Creating a new read only snapshot...")
sudo btrfs subvolume snapshot -r /run/media/$USER/SAWY_01_B/SAWY_BACKUP/@current/ /run/media/$USER/SAWY_01_B/SAWY_BACKUP/@previous

console.print(f"[bold cyan]Synchronizing...")
rsync --delete --progress -vahi /run/media/$USER/SAWY_01_A/SAWY/ /run/media/$USER/SAWY_01_B/SAWY_BACKUP/@current/

date > ~/Software/logs/sawy-backup.txt

console.rule(style="cyan")

sound-play-success &
