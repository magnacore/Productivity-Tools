#!/home/manuj/anaconda3/envs/xonsh/bin/xonsh
cyan = '\x1b[1;36m'
no_color = '\x1b[0m'

print(f"{cyan}Deleting previous snapshot...{no_color}")
sudo btrfs subvolume delete /run/media/$USER/LAPTOP_BACKUP_B/@previous

print(f"{cyan}Creating a new read only snapshot...{no_color}")
sudo btrfs subvolume snapshot -r /run/media/$USER/LAPTOP_BACKUP_B/@current/ /run/media/$USER/LAPTOP_BACKUP_B/@previous

print(f"{cyan}Synchronizing...{no_color}")
rsync --delete --progress --exclude-from=$HOME/Backups/RSYNC_EXCLUDE/rsync-homedir-local.txt -vahi $HOME/ /run/media/$USER/LAPTOP_BACKUP_B/@current/

date > ~/Software/logs/laptop-backup-b.txt

sudo btrfs filesystem show

print(f"{cyan}Done.{no_color}")
