#!xonsh

import os
import sys
from simple_term_menu import TerminalMenu

root_dir = p"~/.password-store/"

# sys.argv[0] is the name of the script which will always be there
if len(sys.argv) == 1: # No arguments passed
	selection = False
elif len(sys.argv) > 1:
	selection = True

if selection:
    password_search = sys.argv[1]

    search_result = []

    for root, dirs, files in os.walk(root_dir):
        for name in files:
        
            abs_path = os.path.abspath(os.path.join(root, name))

            abs_path = abs_path.replace("/home/manuj/.password-store/", "")
            abs_path = abs_path.replace(".gpg", "")

            if password_search in abs_path:
                search_result.append(abs_path)

    terminal_menu = TerminalMenu(search_result)
    menu_entry_index = terminal_menu.show()

    selection = search_result[menu_entry_index]

    pass -c @(selection)

    print(u'\u2500' * os.get_terminal_size().columns)

else:
    print("Please provide a keyword.")